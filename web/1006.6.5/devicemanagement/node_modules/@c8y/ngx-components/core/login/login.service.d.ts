import { FetchClient, BasicAuth, ICredentials, SystemOptionsService, Realtime, UserService, TenantService, IAuthentication, CookieAuth } from '@c8y/client';
import { AppStateService } from '../common/ui-state.service';
import { AlertService } from '../alert/alert.service';
import { ApiService } from '@c8y/ngx-components/api';
import { LocationStrategy } from '@angular/common';
/**
 * Service to manage the login.
 */
export declare class LoginService {
    private client;
    private basicAuth;
    private cookieAuth;
    private systemOptions;
    private ui;
    private user;
    private tenant;
    private realtime;
    private alert;
    private api;
    private location;
    rememberMe: boolean;
    TOKEN_KEY: string;
    TFATOKEN_KEY: string;
    OAUTH2_INTERNAL_TYPE: string;
    loginMode: any;
    oauthOptions: any;
    isFirstLogin: boolean;
    ERROR_MESSAGES: {
        minlength: any;
        password_missmatch: any;
        maxlength: any;
        password_strength: any;
        remote_error: any;
        email: any;
        password_change: any;
        password_reset_token_expired: any;
        tfa_pin_invalid: any;
        pattern_phonenumber: any;
        pattern_newPassword: any;
        international_number_required: any;
        phone_number_error: any;
        pinAlreadySent: any;
        passwordConfirm: any;
        tfaExpired: any;
    };
    private SUCCESS_MESSAGES;
    private passwordStrengthSetting;
    private localhostRegExp;
    private localhostIpRegExp;
    private showTenantRegExp;
    constructor(client: FetchClient, basicAuth: BasicAuth, cookieAuth: CookieAuth, systemOptions: SystemOptionsService, ui: AppStateService, user: UserService, tenant: TenantService, realtime: Realtime, alert: AlertService, api: ApiService, location: LocationStrategy);
    /**
     * Returns the current tenant.
     * @return The tenant name.
     */
    getTenant(): string;
    initLoginOptions(): void;
    redirectToOauth(): void;
    autoLogout(): void;
    /**
     * Checks the password for the min length.
     * @return The min length or undefined if not configured.
     */
    getGreenMinLength(): Promise<number>;
    /**
     * Checks if password strength is enforced.
     * @return true if enforced.
     */
    getEnforcePasswordStrength(): Promise<boolean>;
    /**
     * Clears all backend errors.
     */
    cleanMessages(): void;
    /**
     * Adds a new success message
     * @param successKey The key of the success message as used in SUCCESS_MESSAGES
     */
    addSuccessMessage(successKey: string): void;
    /**
     * Returns the current strategy. Defaults to cookie, if a token
     * is found in local or session storage we switch to basic auth.
     * @returns The current auth strategy.
     */
    getAuthStrategy(): IAuthentication;
    /**
     * Forces the use of basic auth as strategy with this credentials.
     * @param credentials The credentials to use.
     */
    useBasicAuth(credentials: ICredentials): BasicAuth;
    /**
     * Tries to login a user with the given credentials.
     * If successful, the current tenant and user is set. If not an error
     * is thrown. It also verifies if the user is allowed to open the
     * current app.
     * @param auth The authentication strategy used.
     * @param credentials The credentials to try to login.
     */
    login(auth?: IAuthentication, credentials?: ICredentials): Promise<void>;
    /**
     * Saves tenant and user to the app state
     * @param tenant The current tenant object.
     * @param user The current user objet
     */
    authFulfilled(tenant?: any, user?: any): Promise<void>;
    /**
     * Switch the login mode to CookieAuth if the
     * user has configured to use it in loginOptions.
     * @param credentials The credentials for that login
     */
    switchLoginMode(credentials?: ICredentials): Promise<boolean>;
    isPasswordGrantLogin(credentials?: ICredentials): boolean;
    /**
     * Verifies if the tenant input field should be shown
     * or not.
     * @returns If true, show the tenant input.
     */
    showTenant(): boolean;
    /**
     * Logs the user out
     * @param reload If set to false, the page will not reload
     */
    logout(reload?: boolean): Promise<void>;
    /**
     * Resets the stored auth-data
     */
    reset(): Promise<[void, import("@c8y/client").IFetchResponse]>;
    /**
     * Saves the TFA token to local or session storage.
     * @param tfaToken The tfa token to save.
     * @param storage The storage to use (local or session).
     */
    saveTFAToken(tfaToken: string, storage: Storage): void;
    /**
     * Request the manifest -> on 401 user has no access to that application
     * and we throw the error up to the login form.
     */
    verifyAppAccess(): Promise<void>;
    /**
     * Sets the tenant to the client and updates the credentials on the
     * auth strategy.
     * @param credentials The name of the tenant.
     * @param authStrategy The authentication strategy used.
     * @return Returns the token if basic auth, otherwise undefined.
     */
    private setCredentials;
    /**
     * Verifies if the current user is a developer or not.
     * Running on localhost means development mode.
     */
    private isLocal;
    /**
     * Save the token to local or session storage.
     * @param token The token to save.
     * @param storage The storage to use (local or session).
     */
    private saveToken;
    private storeBasicAuthToken;
    private cleanLocalStorage;
    private cleanSessionStorage;
    private isShowTenant;
    private redirect;
}
