"use strict";function _objectSpread(n){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?Object(arguments[e]):{},t=Object.keys(r);"function"==typeof Object.getOwnPropertySymbols&&(t=t.concat(Object.getOwnPropertySymbols(r).filter(function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable}))),t.forEach(function(e){_defineProperty(n,e,r[e])})}return n}function _defineProperty(e,n,r){return n in e?Object.defineProperty(e,n,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[n]=r,e}!function(){e.$inject=["c8yDeviceTypeProtocolBaseProvider","gettext"];var r="c8ySNMPDevice";function e(e,b){n.$inject=["c8yDeviceDatabase","c8yDeviceControl","c8yTenant","c8yDevices","c8yBase","c8yUser","$q"];var y={label:b("SNMP"),fieldbusType:"snmp",serviceName:r};return e.getDeviceTypeProtocolProvider(y,n);function n(n,s,r,u,l,a,t){var i={name:"snmp-mib-parser"},c=_objectSpread({},y,{options:!1,discreteOutputs:!1,discreteInputs:!1,holdingRegisters:{sectionTitle:b("Components"),noRegistersDefinedMessage:b("No components defined."),elementTypeLabel:b("Component"),newRegisterModalTitle:b("New component"),editRegisterModalTitle:b('Edit component: "{{name}}"'),addRegisterButtonLabel:b("Add component"),validation:{invalidName:b("Name must be unique among components.")},description:!0,oid:!0,functionalities:{raiseAlarm:!0,sendMeasurement:!0,sendEvent:!0}},deviceFragments:["c8y_SNMPDevice","c8y_SNMPGateway"],deviceConfiguration:{fragment:"c8y_SNMPGateway",icon:"cogs"}}),e=l.createEnum([{value:0,label:b("Version 1"),name:"VERSION_1"},{value:1,label:b("Version 2c"),name:"VERSION_2C"},{value:3,name:"VERSION_3",label:b("Version 3")}]),o=l.createEnum([{value:1,name:"NOAUTH_NOPRIV",label:b("NOAUTH_NOPRIV")},{value:2,name:"AUTH_NOPRIV",label:b("AUTH_NOPRIV")},{value:3,name:"AUTH_PRIV",label:b("AUTH_PRIV")}]),d=l.createEnum([{value:1,name:"MD5",label:b("MD5")},{value:2,name:"SHA",label:b("SHA")}]);return{registerFeaturesManifest:function(){n.registerFeaturesManifest(v().then(function(e){return e&&c}))},isSubscribed:v,create:function(a,i){var c,o;return regeneratorRuntime.async(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,regeneratorRuntime.awrap(p(a,i));case 2:return c=e.sent,e.t0=l,e.next=6,regeneratorRuntime.awrap(u.createConfirm(c));case 6:return e.t1=e.sent,o=e.t0.getResData.call(e.t0,e.t1),e.next=10,regeneratorRuntime.awrap(u.addChildDevice(a,o));case 10:return o.owner=a.owner,e.next=13,regeneratorRuntime.awrap(u.save(o));case 13:return e.abrupt("return",s.create((n=a,r=i.deviceType,t=o,{deviceId:n.id,description:'Added new child device to "'.concat(n.name,'" (ID: ').concat(n.id,")."),c8y_SNMPDevice:m(r,t)})));case 14:case"end":return e.stop()}var n,r,t},null,null,null,Promise)},update:function(a,i){var c;return regeneratorRuntime.async(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,regeneratorRuntime.awrap(p(a,i));case 2:return(c=e.sent).id=i.id,c.owner=a.owner,e.next=7,regeneratorRuntime.awrap(u.update(c));case 7:return e.abrupt("return",s.create((n=a,r=i.deviceType,t=c,{deviceId:n.id,description:'Updated child device of "'.concat(n.name,'" (ID: ').concat(n.id,")."),c8y_SNMPDevice:m(r,t)})));case 8:case"end":return e.stop()}var n,r,t},null,null,null,Promise)},isSNMP:function(e){return!!(e||{}).c8y_SNMPDevice},snmpVersions:e,snmpAuthPrivProtocols:l.createEnum([{value:1,name:"DES",label:b("DES")},{value:2,name:"AES128",label:b("AES128")},{value:3,name:"AES192",label:b("AES192")},{value:4,name:"AES256",label:b("AES256")}]),snmpAuthProtocols:d,snmpSecurityLevels:o};function v(){var e={isFeatureFieldbus4Available:n.isFeatureFieldbus4Available(),isSubscribed:r.isSubscribed(i)};return t.all(e).then(function(e){return e.isFeatureFieldbus4Available&&e.isSubscribed})}function p(e,r){var t;return regeneratorRuntime.async(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,regeneratorRuntime.awrap(a.current());case 2:return t=e.sent,e.abrupt("return",{name:r.name,type:r.deviceType.name,c8y_SNMPDevice:{ipAddress:r.ipAddress,port:r.port,version:r.version,auth:(n=r.auth,_.pick(n,["username","privPassword","authPassword","authProtocol","privProtocol","securityLevel","engineId"])),type:"/inventory/managedObjects/".concat(r.deviceType.id)},owner:t.id});case 4:case"end":return e.stop()}var n},null,null,null,Promise)}function m(e,n){return{id:n.id,name:n.name,ipAddress:n.c8y_SNMPDevice.ipAddress,port:n.c8y_SNMPDevice.port,version:n.c8y_SNMPDevice.version,auth:n.c8y_SNMPDevice.auth,type:"/inventory/managedObjects/".concat(e.id)}}}}angular.module("c8y.snmp").provider(r,e)}();