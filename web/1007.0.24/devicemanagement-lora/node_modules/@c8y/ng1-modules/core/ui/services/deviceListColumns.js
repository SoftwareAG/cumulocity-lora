"use strict";!function(){function e(r,e,t,i,n){function a(e){return"/device/".concat(e.id)}function s(){return{name:"status",header:i("Status"),cell:{style:{width:"90px"},class:{"text-center":!0},template:'<c8y-device-status-display device="item"></c8y-device-status-display>'},filtering:{schema:{type:"object",properties:{sendOnline:{type:"boolean"},sendOffline:{type:"boolean"},sendUnknown:{type:"boolean"},sendNotMonitored:{type:"boolean"},pushOnline:{type:"boolean"},pushOffline:{type:"boolean"},pushUnknown:{type:"boolean"},maintenance:{type:"boolean"}}},form:[{type:"template",template:["<label><span translate>",i("Show devices with send status"),"</span>:</label>"].join("")},{key:"sendOnline",title:n.getString("Online")},{key:"sendOffline",title:n.getString("Offline")},{key:"sendUnknown",title:n.getString("Unknown")},{key:"sendNotMonitored",title:n.getString("Not monitored")},{type:"template",template:["<label><span translate>",i("Show devices with push status"),"</span>:</label>"].join("")},{key:"pushOnline",title:n.getString("Online")},{key:"pushOffline",title:n.getString("Offline")},{key:"pushUnknown",title:n.getString("Not monitored")},{type:"template",template:["<label><span translate>",i("Show devices with maintenance status"),"</span>:</label>"].join("")},{key:"maintenance",title:n.getString("Device is under maintenance")}],getFilter:function(e){var t={},i=[],n=[],a=[];return e&&(e.sendOnline&&n.push("AVAILABLE"),e.maintenance&&n.push("MAINTENANCE"),e.sendOffline&&n.push("UNAVAILABLE"),e.sendUnknown&&i.push({__and:[{__not:{__has:"c8y_Availability.status"}},{__has:"c8y_RequiredAvailability"}]}),e.sendNotMonitored&&i.push({__and:[{__not:{__has:"c8y_Availability.status"}},{__not:{__has:"c8y_RequiredAvailability"}}]}),e.pushOnline&&a.push("CONNECTED"),e.pushOffline&&a.push("DISCONNECTED"),e.pushUnknown&&i.push({__not:{__has:"c8y_Connection.status"}}),n.length&&i.push({"c8y_Availability.status":{__in:n}}),a.length&&i.push({"c8y_Connection.status":{__in:a}}),i.length&&(t.__or=i)),t}},sorting:{path:"c8y_Availability.status"}}}function l(){return{name:"name",header:i("Name"),style:{"min-width":"200px"},cell:{template:['<a ng-href="#{{getDeviceLink(item)}}" title="{{item.properName}}" class="interact">',"  {{item.properName}}","</a>"].join("\n"),scopeExtensions:{getDeviceLink:a},class:"table-cell-truncate",innerClass:"truncated-cell-content"},filtering:{schema:{type:"object",properties:{names:{type:"array",items:{type:"string"}}}},form:[{key:"names",title:n.getString("Show devices with name"),add:n.getString("Or"),items:[{key:"names[]",notitle:!0,placeholder:n.getString("e.g. My Device, you can use an asterisk (*) as wildcard character")}]}],getFilter:_.partial(t.getInFilterFromModel,"names","name")},sorting:{path:"name"}}}function o(){return{name:"model",header:i("Model"),cell:{template:"{{model(item)}}",scopeExtensions:{model:e.model}},filtering:{schema:{type:"object",properties:{models:{type:"array",items:{type:"string"}}}},form:[{key:"models",title:n.getString("Show devices with model"),add:n.getString("Or"),items:[{key:"models[]",notitle:!0,placeholder:n.getString("e.g. ModelName, you can use an asterisk (*) as wildcard character")}]}],getFilter:_.partial(t.getInFilterFromModel,"models","c8y_Hardware.model")},sorting:{path:"c8y_Hardware.model"}}}function c(){return{name:"serialNumber",header:i("Serial number"),cell:{template:"{{serial(item)}}",scopeExtensions:{serial:e.serial}},filtering:{schema:{type:"object",properties:{serialNumbers:{type:"array",items:{type:"string"}}}},form:[{key:"serialNumbers",title:n.getString("Show devices with serial number"),add:n.getString("Or"),items:[{key:"serialNumbers[]",notitle:!0,placeholder:n.getString("e.g. 54321-123, you can use an asterisk (*) as wildcard character")}]}],getFilter:_.partial(t.getInFilterFromModel,"serialNumbers","c8y_Hardware.serialNumber")},sorting:{path:"c8y_Hardware.serialNumber"}}}function m(){return{name:"group",header:i("Group"),cell:{template:"\n            <span title=\"{{getAssetParentsNames(item.assetParents.references,\n              ctrl.columnsConfig['group'].filtering.deviceGroupId)}}\">\n              {{getAssetParentsNames(item.assetParents.references,\n                ctrl.columnsConfig['group'].filtering.deviceGroupId)}}\n            </span>\n          ",scopeExtensions:{getAssetParentsNames:function(e,t){var i=_.map(e,"managedObject"),n=_.sortBy(i,["name"]),a=_.remove(n,{id:t}).concat(n);return _.map(a,"name").join(", ")}}},filtering:{schema:{type:"object",properties:{deviceGroupId:{type:"integer",format:"deviceGroupId"}}},form:[{key:"deviceGroupId",title:n.getString("Show devices in group")}],getFilter:function(e){var t={};return e.deviceGroupId&&(t.__bygroupid=e.deviceGroupId),t}}}}function p(){return{name:"registrationDate",header:i("Registration date"),cell:{template:"{{item.creationTime | absoluteDate}}"},filtering:{schema:{type:"object",properties:{registrationDate:{type:"object",properties:{after:{type:"string",format:"datetime"},before:{type:"string",format:"datetime"}}}}},form:[{key:"registrationDate.after",title:n.getString("Show devices registered after"),maxDateKey:"registrationDate.before"},{key:"registrationDate.before",title:n.getString("And before`date`"),minDateKey:"registrationDate.after"}],getFilter:function(e){var t={},i=e&&e.registrationDate;if(i&&(i.after||i.before)){if(t.__and=[],i.after){var n=moment(i.after).format(r.dateFullFormat);t.__and.push({__or:{creationTime:{__gt:n},"creationTime.date":{__gt:n}}})}if(i.before){var a=moment(e.registrationDate.before).format(r.dateFullFormat);t.__and.push({__or:{creationTime:{__lt:a},"creationTime.date":{__lt:a}}})}}return t}},sorting:{paths:[{path:"creationTime.date",orderModifier:1},{path:"creationTime",orderModifier:1}]}}}function g(){return{name:"systemId",header:i("System ID"),cell:{template:"{{item.id}}"},filtering:{schema:{type:"object",properties:{ids:{type:"array",items:{type:"string"}}}},form:[{key:"ids",title:n.getString("Show devices with system ID"),add:n.getString("Or"),items:[{key:"ids[]",notitle:!0,placeholder:n.getString("e.g. 10300, you can use an asterisk (*) as wildcard character")}]}],getFilter:_.partial(t.getInFilterFromModel,"ids","id")},sorting:{path:"id"}}}function u(){return{name:"imei",order:8,header:i("IMEI"),cell:{template:"{{item.c8y_Mobile.imei}}"},filtering:{schema:{type:"object",properties:{imeis:{type:"array",items:{type:"string"}}}},form:[{key:"imeis",title:n.getString("Show devices with IMEI"),add:n.getString("Or"),items:[{key:"imeis[]",notitle:!0,placeholder:n.getString("e.g. 46543432321, you can use an asterisk (*) as wildcard character")}]}],getFilter:_.partial(t.getInFilterFromModel,"imeis","c8y_Mobile.imei")},sorting:{path:"c8y_Mobile.imei"}}}function d(){return{name:"alarms",header:i("Alarms"),cell:{class:{"text-center":!0},style:{"min-width":"130px"},template:['<a ng-href="#{{getDeviceAlarmsLink(item)}}" class="listLink">','  <small class="status critical" ng-if="item.c8y_ActiveAlarmsStatus.critical" style="white-space: nowrap;">','    {{item.c8y_ActiveAlarmsStatus.critical}} <i c8y-icon="warning"></i>',"  </small>",'  <small class="status major" ng-if="item.c8y_ActiveAlarmsStatus.major" style="white-space: nowrap;">','    {{item.c8y_ActiveAlarmsStatus.major}} <i c8y-icon="exclamation-circle"></i>',"  </small>",'  <small class="status minor" ng-if="item.c8y_ActiveAlarmsStatus.minor" style="white-space: nowrap;">','    {{item.c8y_ActiveAlarmsStatus.minor}} <i c8y-icon="exclamation-circle"></i>',"  </small>",'  <small class="status warning" ng-if="item.c8y_ActiveAlarmsStatus.warning" style="white-space: nowrap;">','    {{item.c8y_ActiveAlarmsStatus.warning}} <i c8y-icon="circle"></i>',"  </small>","</a>"].join("\n"),scopeExtensions:{getDeviceAlarmsLink:function(e){return[a(e),"alarms"].join("/")}}},filtering:{schema:{type:"object",properties:{critical:{type:"boolean"},major:{type:"boolean"},minor:{type:"boolean"},warning:{type:"boolean"},none:{type:"boolean"}}},form:[{type:"template",template:["<label><span translate>",i("Show devices with active"),"</span>:</label>"].join("")},{key:"critical",title:n.getString("Critical alarms")},{key:"major",title:n.getString("Major alarms")},{key:"minor",title:n.getString("Minor alarms")},{key:"warning",title:n.getString("Warnings")},{key:"none",title:n.getString("No alarms")}],getFilter:function(e){var t={},i=[];return e.critical&&i.push({"c8y_ActiveAlarmsStatus.critical":{__gt:0}}),e.major&&i.push({"c8y_ActiveAlarmsStatus.major":{__gt:0}}),e.minor&&i.push({"c8y_ActiveAlarmsStatus.minor":{__gt:0}}),e.warning&&i.push({"c8y_ActiveAlarmsStatus.warning":{__gt:0}}),e.none&&(i.push({__not:{__has:"c8y_ActiveAlarmsStatus"}}),i.push({__and:_.map(["critical","major","minor","warning"],function(e){var t={},i={__not:{__has:void 0}},n="c8y_ActiveAlarmsStatus.".concat(e);return t[n]=0,i.__not.__has=n,{__or:[t,i]}})})),i.length&&(t.__or=i),t}}}}function y(t){return{name:"removalColumn",cell:{class:{"text-center":!0},style:{"min-width":"130px"},template:['<button class="btn-dot showOnHover"\n              uib-tooltip="{{\''.concat(i("Delete device"),'\' | translate}}"\n              tooltip-append-to-body="true"\n              tooltip-placement="left"\n              ng-click="onClickDelete(item)">'),'  <i c8y-icon="minus-circle" class="text-danger"></i>',"</button>"].join("\n"),scopeExtensions:{onClickDelete:function(e){t&&t(e)}}}}}return{getStatusColumn:s,getNameColumn:l,getModelColumn:o,getSerialNumberColumn:c,getGroupColumn:m,getRegistrationDateColumn:p,getSystemIdColumn:g,getImeiColumn:u,getAlarmsColumn:d,getRemovalColumn:y,getParentDeviceColumns:function(e){var t=e||{};return[s(),l(),o(),c(),m(),p(),g(),u(),d(),y(t.clickDeleteCallback)]},getChildDeviceColumns:function(e){var t=e||{};return[s(),l(),o(),c(),p(),g(),u(),d(),y(t.clickDeleteCallback)]}}}e.$inject=["c8yBase","c8yDevices","c8yFilteringSortingInventoryQueries","gettext","gettextCatalog"],angular.module("c8y.ui").factory("c8yDeviceListColumns",e)}();