"use strict";angular.module("c8y.deviceSelector").directive("c8yDeviceSelectorComboDevices",function(){return{restrict:"A",link:function(e,i){e.__el=i;var t=e.depth||0;function l(){e.child.openChildren=e.idPath&&!!e.idPath[t]&&e.idPath[t]===e.child.id&&e.selectedChildDevice.id!==e.child.id,e.child.openChildren&&e.toggleChildren(e,e.child)}e.$evalAsync(function(){return e.propagateToggle.value&&l()})}}}).directive("c8yDeviceSelectorCombo",["$compile",function(t){return{restrict:"EA",scope:{parent:"=?",selectedChildDevice:"=?",selectedChildDeviceId:"=?",contextPaths:"=?",onSelect:"&",groupsSelectable:"=?",idPath:"=?",emptySelectionAvailable:"&?",emptySelectionIcon:"&?",emptySelectionLabel:"&?",readOnly:"<",readOnlyInfo:"&?"},templateUrl:":::PLUGIN_PATH:::/views/deviceSelectorCombo.html",controller:"DeviceSelectorComboCtrl",require:"?^form",link:{post:function(c,n,e,i){var r=t('<div ng-include="\':::PLUGIN_PATH:::/views/deviceSelectorCombo.html\'" ng-controller="DeviceSelectorComboCtrl"></div>');c.top=!0,c.form=i,c.form&&c.selectedChildDevice&&!c.selectedChildDevice.id&&c.form.$setValidity("deviceSelected",!1),c.toggleChildren=function(e,i,t){return c._toggleChildren($(e.target),i,t)},c._toggleChildren=function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:n,i=1<arguments.length&&void 0!==arguments[1]?arguments[1]:c,t=2<arguments.length?arguments[2]:void 0,l=e.hasClass("deviceRow")?e:e.parents(".deviceRow").first();if(t.openChildren=!t.openChildren,t.openChildren){var o=i.$new();(t.childrenNewScope=o).openChildren=!1,o.propagateToggle=i.propagateToggle,o.parent=t,o.depth=_.isNumber(i.depth)?i.depth+1:1,o.children=[],o.top=!1,r(o,function(e){l.append(e)})}else l.children().last().remove(),t.childrenNewScope.$destroy(),delete t.childrenNewScope}}}}}]);