"use strict";!function(){function e(a,t,e,i,n,r,o,l,c){var s=this,u="alarm.type.mapping",p=l("Alarm mappings automatically transform the description and severity based on alarm type matching. Alarm types are a defined property of each alarm created on the platform."),m=e.createEnum([{name:"NONE",label:l("Drop"),icon:"circle",class:"text-muted"},{name:"CRITICAL",label:l("Critical"),icon:O("critical"),class:"status critical"},{name:"MAJOR",label:l("Major"),icon:O("major"),class:"status major"},{name:"MINOR",label:l("Minor"),icon:O("minor"),class:"status minor"},{name:"WARNING",label:l("Warning"),icon:O("warning"),class:"status warning"}]);function g(e){a.options=e,function(e){var t=e.then(function(e){return{title:l("Alarm mapping"),subtitle:!_.isUndefined(e)&&0<e?c.getPlural(e,"1 mapping","{{$count}} mappings",{qty:e}):""}});o.changeTitle(t)}(t.when(e.length))}function f(e){var t=e.value.split("|");return e.severity=t.shift(),e.description=t.join("|"),delete e.value,e}function y(e){return{key:e.key,category:e.category,value:"".concat(e.severity,"|").concat(e.description||"")}}function d(e){return _.map(e,f)}function h(){var e={category:u};a.loading=!0,i.detail(e).then(v).then(d).then(g).finally(function(){a.loading=!1})}function v(e){return _.map(e.data,function(e,t){return{category:u,value:e,key:t}})}function O(e){return n.icon(e)||"circle"}function b(){a.newOption={category:u,severity:"WARNING"},s.newOption=a.newOption}a.severities=m,s.severities=m,a.icon=O,a.iconClass=function(e){return"NONE"===e?"text-muted":e},a.getOptionCopy=function(e){return _.cloneDeep(e)},a.refresh=h,a.add=b,a.save=function(e){var t="".concat(function(e){return!e.self}(e)?"create":"update","Option"),n=y(e);i[t](n).finally(function(){a.status.isOpen=!1,delete a.newOption,delete s.newOption}).then(h)},a.onClickDelete=function(e){var t=y(e);r({title:l("Delete alarm mapping"),body:c.getString('You are about to delete alarm mapping for alarm type "{{alarmType}}". Do you want to proceed?',{alarmType:e.key}),status:"danger",size:"sm",labels:{ok:l("Delete")}}).then(angular.bind(i,i.deleteOption,t)).then(h)},a.helpText=p,a.paging={refresh:!0},a.status={isOpen:!1},h(),a.$watch("status.isOpen",function(e){e&&b()})}e.$inject=["$scope","$q","c8yBase","c8ySettings","c8yAlarms","c8yModal","c8yTitle","gettext","gettextCatalog"],angular.module("c8y.parts.alarmMapping").controller("alarmMappingCtrl",e)}();